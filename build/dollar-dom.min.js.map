{"version":3,"file":"dollar-dom.min.js","sources":["../index.js"],"sourcesContent":["const HTML_REGEX = /^\\<.*\\>$/m;\nconst domFactory = document.createElement('div');\n\nconst closest = (event, selector) => {\n  let {target} = event;\n  while(target && target !== document.body){\n    if(target.matches && target.matches(selector)){\n      break;\n    } else {\n      target = target.parentNode;\n    }\n  }\n  return target;\n}\n\nconst generateDOM = str => {\n  domFactory.innerHTML = str;\n  return domFactory.childNodes ? domFactory.childNodes[0] : null;\n};\n\nconst generateHandler = ({ elem, handler, childSelector }) => {\n  if(!childSelector){\n    return handler.bind(elem);\n  }\n  return (...args) => {\n    let target = closest(args[0], childSelector);\n    if(target){\n      return handler.apply(target, args);\n    }\n  }\n};\n\nconst $ = (args, parent) => {\n  args = args.trim();\n  if(HTML_REGEX.test(args)) {\n    return generateDOM(args);\n  }\n  parent = typeof parent === 'string' ? document.querySelector(parent) : parent;\n  let collection =  Array.from(\n    (parent || document).querySelectorAll(args)\n  );\n\n  let firstElem = collection[0];\n  for(let prop in firstElem){\n    Object.defineProperty(collection, prop, \n      typeof firstElem[prop] === 'function' ?\n      {\n        value: firstElem[prop].bind(firstElem)\n      } :\n      {\n        get(){\n          return firstElem[prop];\n        },\n        set(v){\n          firstElem[prop] = v;\n        }\n      }\n    )\n  }\n\n  Object.defineProperties(collection, {\n    'get': {\n      value: function(index){\n        return collection[index];\n      }\n    },\n    'on': {\n      value: function(...args){\n        let removeHandlers = collection.map(elem => on(elem, ...args));\n        return () => {\n          removeHandlers.forEach(fn => fn());\n        };\n      }\n    }\n  })\n\n  return collection;\n};\n\nconst on = (elem, event, ...args) => {\n  let handler, childSelector;\n  handler = args.shift();\n  if( typeof handler !== 'function' ){\n    childSelector = handler;\n    handler = args.shift();\n  }\n\n  handler = generateHandler({ elem, handler, childSelector });\n  elem.addEventListener(event, handler);\n  return () => {\n    elem.removeEventListener(event, handler);\n  }\n};\n\nexport default {\n  $,\n  on\n};"],"names":["HTML_REGEX","domFactory","document","createElement","closest","target","event","body","matches","selector","parentNode","generateDOM","innerHTML","str","childNodes","generateHandler","elem","handler","childSelector","args","apply","bind","on","shift","addEventListener","removeEventListener","trim","test","parent","querySelector","collection","Array","from","querySelectorAll","firstElem","defineProperty","prop","v","defineProperties","index","removeHandlers","map","forEach","fn"],"mappings":"sLAAA,GAAMA,GAAa,WAAnB,CACMC,EAAaC,SAASC,aAATD,CAAuB,KAAvBA,CADnB,CAGME,EAAU,aAAqB,QAC9BC,GAAUC,EAAVD,MAD8B,CAE7BA,GAAUA,IAAWH,SAASK,IAFD,IAG9BF,EAAOG,OAAPH,EAAkBA,EAAOG,OAAPH,CAAeI,CAAfJ,CAHY,KAMtBA,EAAOK,UANe,OAS5BL,EATT,CAHA,CAeMM,EAAc,WAAO,UACdC,UAAYC,EAChBZ,EAAWa,UAAXb,CAAwBA,EAAWa,UAAXb,CAAsB,CAAtBA,CAAxBA,CAAmD,IAF5D,CAfA,CAoBMc,EAAkB,WAAsC,IAAnCC,KAAAA,KAAMC,IAAAA,QAASC,IAAAA,cAAoB,MACxDA,EADwD,CAIrD,UAAa,4BAATC,4CACLd,GAASD,EAAQe,EAAK,CAALA,CAARf,CAAiBc,CAAjBd,KACVC,QACMY,GAAQG,KAARH,CAAcZ,CAAdY,CAAsBE,CAAtBF,CAHX,CAJ4D,CAEnDA,EAAQI,IAARJ,CAAaD,CAAbC,CAFX,CApBA,CA+EMK,EAAK,aAA0B,4BAATH,sDACtBF,GAASC,WACHC,EAAKI,KAALJ,GACa,UAAnB,QAAOF,OACOA,IACNE,EAAKI,KAALJ,MAGFJ,EAAgB,CAAEC,MAAF,CAAQC,SAAR,CAAiBC,eAAjB,CAAhBH,IACLS,iBAAiBlB,EAAOW,GACtB,UAAM,GACNQ,oBAAoBnB,EAAOW,EADlC,CAVF,CA/EA,OA8Fe,GA9DL,aAAkB,MACnBE,EAAKO,IAALP,GACJnB,EAAW2B,IAAX3B,CAAgBmB,CAAhBnB,QACMW,GAAYQ,CAAZR,IAEkB,QAAlB,QAAOiB,EAAP,CAA6B1B,SAAS2B,aAAT3B,CAAuB0B,CAAvB1B,CAA7B,CAA8D0B,CAL7C,IAMtBE,GAAcC,MAAMC,IAAND,CAChB,CAACH,GAAU1B,QAAX,EAAqB+B,gBAArB,CAAsCd,CAAtC,CADgBY,EAIdG,EAAYJ,EAAW,CAAXA,uBAEPK,eAAeL,EAAYM,EACL,UAA3B,QAAOF,GAAUE,CAAVF,CAAP,CACA,OACSA,EAAUE,CAAVF,EAAgBb,IAAhBa,CAAqBA,CAArBA,CADT,CADA,CAIA,eACO,OACIA,GAAUE,CAAVF,CAFX,CAAA,gBAIQ,GACME,GAAQC,EALtB,QANA,GAAID,KAAQF,KAARE,iBAiBDE,iBAAiBR,EAAY,KAC3B,OACE,WAAe,OACbA,GAAWS,CAAXT,EAFJ,CAD2B,IAM5B,OACG,UAAiB,4BAALX,4CACbqB,GAAiBV,EAAWW,GAAXX,CAAe,kBAAQR,QAAAA,SAAGN,UAASG,EAAZG,CAAvB,CAAAQ,QACd,WAAM,GACIY,QAAQ,kBAAMC,IAA7B,EADF,EAHE,CAN4B,GAgB7Bb,CA5CT,CA8De,KAAA"}